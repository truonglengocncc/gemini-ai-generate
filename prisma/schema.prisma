// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Group {
  id        String   @id @default(cuid())
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  jobs Job[]
}

model Job {
  id          String   @id @default(cuid())
  groupId     String
  group       Group    @relation(fields: [groupId], references: [id], onDelete: Cascade)
  
  mode        String   // "automatic" or "semi-automatic"
  status      String   @default("queued") // "queued", "processing", "completed", "failed"
  
  // Input data
  images      Json      // Array of image URLs (stored as JSON for MySQL compatibility)
  prompts     Json?    // Prompts data (can be array or object)
  config      Json?    // Configuration object
  
  // RunPod data
  runpodJobId String?  // RunPod job ID
  
  // Batch API data (for Gemini Batch API)
  batchJobName String? // Gemini batch job name (e.g., "batches/abc123")
  
  // Results
  results     Json?    // Results from RunPod
  error       String?  // Error message if failed
  
  // Timestamps
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  completedAt DateTime?
  
  @@index([groupId])
  @@index([status])
  @@index([runpodJobId])
}

